!function(t){function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}var r=e(1),a=i(r),o=e(5),s=i(o),l=a["default"](".collections-list"),c=l.data("owner"),u=l.data("mode");a["default"](function(){new s["default"]({el:l,enhance:!0,owner:c,mode:u})})},function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=window.jQuery,t.exports=n["default"]},function(t,n,e){var i=e(7);i.Template=e(8).Template,i.template=i.Template,t.exports=i},,,function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),a=i(r),o=e(6),s=i(o),l=e(10),c=i(l),u=e(11),f=i(u),p=e(9),d=i(p),h=mw.mobileFrontend.require("ext.gather.api/CollectionsApi"),b=mw.mobileFrontend.require("InfiniteScroll"),g=mw.mobileFrontend.require("icons"),v=mw.mobileFrontend.require("toast"),m=mw.mobileFrontend.require("View"),w=mw.mobileFrontend.require("Icon");n["default"]=m.extend({defaults:{collections:[],userIconClass:new w({name:"profile",hasText:!0}).getClassName()},template:c["default"],templatePartials:{item:f["default"],image:d["default"]},initialize:function(){m.prototype.initialize.apply(this,arguments),this.$pagination=this.$el.find(".collections-pagination"),this.$pagination.length&&(this._replacePaginationControls(),this.api=new h,this.infiniteScroll=new b,this.infiniteScroll.setElement(this.$el),this.infiniteScroll.on("load",a["default"].proxy(this,"_loadCollections")))},postRender:function(){var t=a["default"](".collections-list");t.data("is-owner")&&"minerva"===mw.config.get("skin")&&new s["default"]({}).appendTo(t.find(".collection-actions")),m.prototype.postRender.apply(this,arguments)},_replacePaginationControls:function(){this.continueArgs={lstcontinue:this._parseContinueUrl(this.$pagination.children("a").attr("href"))},this.$pagination.html(g.spinner().toHtmlString()),this.$pagination.hide()},_parseContinueUrl:function(t){var n=t.split("?")[1].split("&"),e=null;return a["default"].each(n,function(t,n){-1!==n.indexOf("lstcontinue=")&&(e=decodeURIComponent(n.split("=")[1]))}),e},_loadCollections:function(){var t=this;this.continueArgs&&(this.$pagination.show(),this._apiCallByMode().always(function(){t.$pagination.hide(),t.infiniteScroll.enable()}).done(function(n){t.continueArgs=n.continueArgs||!1,t.renderCollections(n.collections)}).fail(function(){return v.show(mw.msg("gather-lists-more-failed"),"toast error")}))},_apiCallByMode:function(){return"recent"===this.options.mode?this.api.getCollections(null,a["default"].extend(this.continueArgs,{lstminitems:4,lstmode:"allpublic"})):this.api.getCurrentUsersCollections(this.options.owner,null,this.continueArgs)},renderCollections:function(t){var n=this;this.$pagination.before(a["default"].map(t,function(t){n.templatePartials.item.render(a["default"].extend({},t,{langdir:"ltr",articleCountMsg:mw.msg("gather-article-count",t.count),owner:Boolean(n.options.owner)?null:{label:t.owner,link:n._getOwnerUrl(t.owner),className:n.options.userIconClass},privacyMsg:n._getPrivacyMsg(t.perm),collectionUrl:n._getUrl(t.id),hasImage:Boolean(t.image),image:n.templatePartials.image.render({url:t.imageurl,wide:t.imagewidth>t.imageheight})}))}))},_getOwnerUrl:function(t){return mw.util.getUrl(["Special:Gather","by",t].join("/"))},_getUrl:function(t){return mw.util.getUrl(["Special:Gather","id",t].join("/"))},_getPrivacyMsg:function(t){switch(t){case"public":return mw.msg("gather-public");case"private":return mw.msg("gather-private");case"hidden":return mw.msg("gather-hidden")}}}),t.exports=n["default"]},function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=mw.mobileFrontend.require("ext.gather.collection.editor/CollectionEditOverlay"),i=mw.mobileFrontend.require("Button"),r=mw.mobileFrontend.require("Icon");n["default"]=i.extend({defaults:{tagName:"div",progressive:!0,label:mw.msg("gather-create-collection-button-label"),additionalClassNames:new r({tagName:"span",name:"collections-icon",hasText:!0}).getClassName()},events:{click:"onCreateCollectionButtonClick"},onCreateCollectionButtonClick:function(t){t.stopPropagation(),t.preventDefault();var n=new e({reloadOnSave:!0});n.show()}}),t.exports=n["default"]},function(t,n,e){!function(t){function n(t){"}"===t.n.substr(t.n.length-1)&&(t.n=t.n.substring(0,t.n.length-1))}function e(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}function i(t,n,e){if(n.charAt(e)!=t.charAt(0))return!1;for(var i=1,r=t.length;r>i;i++)if(n.charAt(e+i)!=t.charAt(i))return!1;return!0}function r(n,e,i,s){var l=[],c=null,u=null,f=null;for(u=i[i.length-1];n.length>0;){if(f=n.shift(),u&&"<"==u.tag&&!(f.tag in y))throw new Error("Illegal content in < super tag.");if(t.tags[f.tag]<=t.tags.$||a(f,s))i.push(f),f.nodes=r(n,f.tag,i,s);else{if("/"==f.tag){if(0===i.length)throw new Error("Closing tag without opener: /"+f.n);if(c=i.pop(),f.n!=c.n&&!o(f.n,c.n,s))throw new Error("Nesting error: "+c.n+" vs. "+f.n);return c.end=f.i,l}"\n"==f.tag&&(f.last=0==n.length||"\n"==n[0].tag)}l.push(f)}if(i.length>0)throw new Error("missing closing tag: "+i.pop().n);return l}function a(t,n){for(var e=0,i=n.length;i>e;e++)if(n[e].o==t.n)return t.tag="#",!0}function o(t,n,e){for(var i=0,r=e.length;r>i;i++)if(e[i].c==t&&e[i].o==n)return!0}function s(t){var n=[];for(var e in t)n.push('"'+c(e)+'": function(c,p,t,i) {'+t[e]+"}");return"{ "+n.join(",")+" }"}function l(t){var n=[];for(var e in t.partials)n.push('"'+c(e)+'":{name:"'+c(t.partials[e].name)+'", '+l(t.partials[e])+"}");return"partials: {"+n.join(",")+"}, subs: "+s(t.subs)}function c(t){return t.replace(m,"\\\\").replace(b,'\\"').replace(g,"\\n").replace(v,"\\r").replace(w,"\\u2028").replace(x,"\\u2029")}function u(t){return~t.indexOf(".")?"d":"f"}function f(t,n){var e="<"+(n.prefix||""),i=e+t.n+k++;return n.partials[i]={name:t.n,partials:{}},n.code+='t.b(t.rp("'+c(i)+'",c,p,"'+(t.indent||"")+'"));',i}function p(t,n){n.code+="t.b(t.t(t."+u(t.n)+'("'+c(t.n)+'",c,p,0)));'}function d(t){return"t.b("+t+");"}var h=/\S/,b=/\"/g,g=/\n/g,v=/\r/g,m=/\\/g,w=/\u2028/,x=/\u2029/;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(r,a){function o(){m.length>0&&(w.push({tag:"_t",text:new String(m)}),m="")}function s(){for(var n=!0,e=k;e<w.length;e++)if(n=t.tags[w[e].tag]<t.tags._v||"_t"==w[e].tag&&null===w[e].text.match(h),!n)return!1;return n}function l(t,n){if(o(),t&&s())for(var e,i=k;i<w.length;i++)w[i].text&&((e=w[i+1])&&">"==e.tag&&(e.indent=w[i].text.toString()),w.splice(i,1));else n||w.push({tag:"\n"});x=!1,k=w.length}function c(t,n){var i="="+C,r=t.indexOf(i,n),a=e(t.substring(t.indexOf("=",n)+1,r)).split(" ");return _=a[0],C=a[a.length-1],r+i.length-1}var u=r.length,f=0,p=1,d=2,b=f,g=null,v=null,m="",w=[],x=!1,y=0,k=0,_="{{",C="}}";for(a&&(a=a.split(" "),_=a[0],C=a[1]),y=0;u>y;y++)b==f?i(_,r,y)?(--y,o(),b=p):"\n"==r.charAt(y)?l(x):m+=r.charAt(y):b==p?(y+=_.length-1,v=t.tags[r.charAt(y+1)],g=v?r.charAt(y+1):"_v","="==g?(y=c(r,y),b=f):(v&&y++,b=d),x=y):i(C,r,y)?(w.push({tag:g,n:e(m),otag:_,ctag:C,i:"/"==g?x-_.length:y+C.length}),m="",y+=C.length-1,b=f,"{"==g&&("}}"==C?y++:n(w[w.length-1]))):m+=r.charAt(y);return l(x,!0),w};var y={_t:!0,"\n":!0,$:!0,"/":!0};t.stringify=function(n,e,i){return"{code: function (c,p,i) { "+t.wrapMain(n.code)+" },"+l(n)+"}"};var k=0;t.generate=function(n,e,i){k=0;var r={code:"",subs:{},partials:{}};return t.walk(n,r),i.asString?this.stringify(r,e,i):this.makeTemplate(r,e,i)},t.wrapMain=function(t){return'var t=this;t.b(i=i||"");'+t+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(t,n,e){var i=this.makePartials(t);return i.code=new Function("c","p","i",this.wrapMain(t.code)),new this.template(i,n,this,e)},t.makePartials=function(t){var n,e={subs:{},partials:t.partials,name:t.name};for(n in e.partials)e.partials[n]=this.makePartials(e.partials[n]);for(n in t.subs)e.subs[n]=new Function("c","p","t","i",t.subs[n]);return e},t.codegen={"#":function(n,e){e.code+="if(t.s(t."+u(n.n)+'("'+c(n.n)+'",c,p,1),c,p,0,'+n.i+","+n.end+',"'+n.otag+" "+n.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(n.nodes,e),e.code+="});c.pop();}"},"^":function(n,e){e.code+="if(!t.s(t."+u(n.n)+'("'+c(n.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(n.nodes,e),e.code+="};"},">":f,"<":function(n,e){var i={partials:{},code:"",subs:{},inPartial:!0};t.walk(n.nodes,i);var r=e.partials[f(n,e)];r.subs=i.subs,r.partials=i.partials},$:function(n,e){var i={subs:{},code:"",partials:e.partials,prefix:n.n};t.walk(n.nodes,i),e.subs[n.n]=i.code,e.inPartial||(e.code+='t.sub("'+c(n.n)+'",c,p,i);')},"\n":function(t,n){n.code+=d('"\\n"'+(t.last?"":" + i"))},_v:function(t,n){n.code+="t.b(t.v(t."+u(t.n)+'("'+c(t.n)+'",c,p,0)));'},_t:function(t,n){n.code+=d('"'+c(t.text)+'"')},"{":p,"&":p},t.walk=function(n,e){for(var i,r=0,a=n.length;a>r;r++)i=t.codegen[n[r].tag],i&&i(n[r],e);return e},t.parse=function(t,n,e){return e=e||{},r(t,"",[],e.sectionTags||[])},t.cache={},t.cacheKey=function(t,n){return[t,!!n.asString,!!n.disableLambda,n.delimiters,!!n.modelGet].join("||")},t.compile=function(n,e){e=e||{};var i=t.cacheKey(n,e),r=this.cache[i];if(r){var a=r.partials;for(var o in a)delete a[o].instance;return r}return r=this.generate(this.parse(this.scan(n,e.delimiters),n,e),n,e),this.cache[i]=r}}(n)},function(t,n,e){!function(t){function n(t,n,e){var i;return n&&"object"==typeof n&&(void 0!==n[t]?i=n[t]:e&&n.get&&"function"==typeof n.get&&(i=n.get(t))),i}function e(t,n,e,i,r,a){function o(){}function s(){}o.prototype=t,s.prototype=t.subs;var l,c=new o;c.subs=new s,c.subsText={},c.buf="",i=i||{},c.stackSubs=i,c.subsText=a;for(l in n)i[l]||(i[l]=n[l]);for(l in i)c.subs[l]=i[l];r=r||{},c.stackPartials=r;for(l in e)r[l]||(r[l]=e[l]);for(l in r)c.partials[l]=r[l];return c}function i(t){return String(null===t||void 0===t?"":t)}function r(t){return t=i(t),u.test(t)?t.replace(a,"&amp;").replace(o,"&lt;").replace(s,"&gt;").replace(l,"&#39;").replace(c,"&quot;"):t}t.Template=function(t,n,e,i){t=t||{},this.r=t.code||this.r,this.c=e,this.options=i||{},this.text=n||"",this.partials=t.partials||{},this.subs=t.subs||{},this.buf=""},t.Template.prototype={r:function(t,n,e){return""},v:r,t:i,render:function(t,n,e){return this.ri([t],n||{},e)},ri:function(t,n,e){return this.r(t,n,e)},ep:function(t,n){var i=this.partials[t],r=n[i.name];if(i.instance&&i.base==r)return i.instance;if("string"==typeof r){if(!this.c)throw new Error("No compiler available.");r=this.c.compile(r,this.options)}if(!r)return null;if(this.partials[t].base=r,i.subs){n.stackText||(n.stackText={});for(key in i.subs)n.stackText[key]||(n.stackText[key]=void 0!==this.activeSub&&n.stackText[this.activeSub]?n.stackText[this.activeSub]:this.text);r=e(r,i.subs,i.partials,this.stackSubs,this.stackPartials,n.stackText)}return this.partials[t].instance=r,r},rp:function(t,n,e,i){var r=this.ep(t,e);return r?r.ri(n,e,i):""},rs:function(t,n,e){var i=t[t.length-1];if(!f(i))return void e(t,n,this);for(var r=0;r<i.length;r++)t.push(i[r]),e(t,n,this),t.pop()},s:function(t,n,e,i,r,a,o){var s;return f(t)&&0===t.length?!1:("function"==typeof t&&(t=this.ms(t,n,e,i,r,a,o)),s=!!t,!i&&s&&n&&n.push("object"==typeof t?t:n[n.length-1]),s)},d:function(t,e,i,r){var a,o=t.split("."),s=this.f(o[0],e,i,r),l=this.options.modelGet,c=null;if("."===t&&f(e[e.length-2]))s=e[e.length-1];else for(var u=1;u<o.length;u++)a=n(o[u],s,l),void 0!==a?(c=s,s=a):s="";return r&&!s?!1:(r||"function"!=typeof s||(e.push(c),s=this.mv(s,e,i),e.pop()),s)},f:function(t,e,i,r){for(var a=!1,o=null,s=!1,l=this.options.modelGet,c=e.length-1;c>=0;c--)if(o=e[c],a=n(t,o,l),void 0!==a){s=!0;break}return s?(r||"function"!=typeof a||(a=this.mv(a,e,i)),a):r?!1:""},ls:function(t,n,e,r,a){var o=this.options.delimiters;return this.options.delimiters=a,this.b(this.ct(i(t.call(n,r)),n,e)),this.options.delimiters=o,!1},ct:function(t,n,e){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(t,this.options).render(n,e)},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ms:function(t,n,e,i,r,a,o){var s,l=n[n.length-1],c=t.call(l);return"function"==typeof c?i?!0:(s=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(c,l,e,s.substring(r,a),o)):c},mv:function(t,n,e){var r=n[n.length-1],a=t.call(r);return"function"==typeof a?this.ct(i(a.call(r)),r,e):a},sub:function(t,n,e,i){var r=this.subs[t];r&&(this.activeSub=t,r(n,e,this,i),this.activeSub=!1)}};var a=/&/g,o=/</g,s=/>/g,l=/\'/g,c=/\"/g,u=/[&<>\"\']/,f=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}(n)},function(t,n,e){var i=e(2);t.exports=function(){var t=new i.Template({code:function(t,n,e){var i=this;return i.b(e=e||""),i.b("<div"),i.b("\n"+e),i.b("  class='list-thumb"),i.b("\n"+e),i.b("        "),i.s(i.f("wide",t,n,1),t,n,0,42,54,"{{ }}")&&(i.rs(t,n,function(t,n,e){e.b("list-thumb-y")}),t.pop()),i.b("\n"+e),i.b("        "),i.s(i.f("wide",t,n,1),t,n,1,0,0,"")||i.b("list-thumb-x"),i.b("'"),i.b("\n"+e),i.b("  style='background-image: url(\""),i.b(i.v(i.f("url",t,n,0))),i.b("\")'></div>"),i.b("\n"),i.fl()},partials:{},subs:{}},"<div\n  class='list-thumb\n        {{#wide}}list-thumb-y{{/wide}}\n        {{^wide}}list-thumb-x{{/wide}}'\n  style='background-image: url(\"{{url}}\")'></div>\n",i);return t}()},function(t,n,e){var i=e(2);t.exports=function(){var t=new i.Template({code:function(t,n,e){var i=this;return i.b(e=e||""),i.b("<div class='collections-list content view-border-box' data-owner=\""),i.b(i.v(i.f("owner",t,n,0))),i.b('"'),i.b("\n"+e),i.b("  data-is-owner='"),i.b(i.t(i.f("isOwner",t,n,0))),i.b("' data-mode='"),i.b(i.v(i.f("mode",t,n,0))),i.b("'>"),i.b("\n"+e),i.b("  <div class='collection-cards'>"),i.b("\n"+e),i.b("    "),i.b(i.t(i.f("items",t,n,0))),i.b("\n"+e),i.b("  </div>"),i.b("\n"+e),i.b("  <div class='collection-actions'></div>"),i.b("\n"+e),i.b("</div>"),i.b("\n"),i.fl()},partials:{},subs:{}},"<div class='collections-list content view-border-box' data-owner=\"{{owner}}\"\n  data-is-owner='{{{isOwner}}}' data-mode='{{mode}}'>\n  <div class='collection-cards'>\n    {{{items}}}\n  </div>\n  <div class='collection-actions'></div>\n</div>\n",i);return t}()},function(t,n,e){var i=e(2);t.exports=function(){var t=new i.Template({code:function(t,n,e){var i=this;return i.b(e=e||""),i.b("<div class='collection-card "),i.s(i.f("hasImage",t,n,1),t,n,1,0,0,"")||i.b("without-image"),i.b("'>"),i.b("\n"+e),i.b("	<a href='"),i.b(i.v(i.f("collectionUrl",t,n,0))),i.b("' class='collection-card-image'>"),i.b("\n"+e),i.b("		"),i.b(i.t(i.f("image",t,n,0))),i.b("\n"+e),i.b("	</a>"),i.b("\n"+e),i.b("	<div class='collection-card-overlay' dir='"),i.b(i.v(i.f("langdir",t,n,0))),i.b("'>"),i.b("\n"+e),i.b("		<div class='collection-card-title'>"),i.b("\n"+e),i.b("			<a href='"),i.b(i.v(i.f("collectionUrl",t,n,0))),i.b("'>"),i.b(i.v(i.f("title",t,n,0))),i.b("</a>"),i.b("\n"+e),i.b("		</div>"),i.b("\n"+e),i.s(i.f("owner",t,n,1),t,n,0,311,388,"{{ }}")&&(i.rs(t,n,function(t,n,i){i.b('		<a class="'),i.b(i.v(i.f("className",t,n,0))),i.b(' collection-owner" href="'),i.b(i.v(i.f("link",t,n,0))),i.b('">'),i.b(i.v(i.f("label",t,n,0))),i.b("</a>"),i.b("\n"+e)}),t.pop()),i.s(i.f("owner",t,n,1),t,n,1,0,0,"")||(i.b("		<span class='collection-card-following'>"),i.b(i.v(i.f("privacyMsg",t,n,0))),i.b("</span>"),i.b("\n"+e)),i.b("		<span>•</span>"),i.b("\n"+e),i.b("		<span class='collection-card-article-count'>"),i.b(i.v(i.f("articleCountMsg",t,n,0))),i.b("</span>"),i.b("\n"+e),i.b("	</div>"),i.b("\n"+e),i.b("</div>"),i.b("\n"),i.fl()},partials:{},subs:{}},"<div class='collection-card {{^hasImage}}without-image{{/hasImage}}'>\n	<a href='{{collectionUrl}}' class='collection-card-image'>\n		{{{image}}}\n	</a>\n	<div class='collection-card-overlay' dir='{{langdir}}'>\n		<div class='collection-card-title'>\n			<a href='{{collectionUrl}}'>{{title}}</a>\n		</div>\n		{{#owner}}\n		<a class=\"{{className}} collection-owner\" href=\"{{link}}\">{{label}}</a>\n		{{/owner}}\n		{{^owner}}\n		<span class='collection-card-following'>{{privacyMsg}}</span>\n		{{/owner}}\n		<span>•</span>\n		<span class='collection-card-article-count'>{{articleCountMsg}}</span>\n	</div>\n</div>\n",i);return t}()}]);